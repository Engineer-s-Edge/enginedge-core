# This is an example secret file for MongoDB.
# DO NOT COMMIT THE ACTUAL SECRET FILE (mongodb-secret.yaml) TO VERSION CONTROL.
#
# IMPORTANT: MongoDB's MONGO_INITDB_ROOT_* environment variables only work on
# FIRST initialization with an empty data directory. If the PVC is reset after
# initial setup, you must manually create users using the fix-mongodb-auth.sh script.
#
# How to use:
# 1. Copy this file: cp mongodb-secret.yaml.example mongodb-secret.yaml
# 2. Choose secure credentials for both root and application users.
# 3. Update the values below (stringData is plain text, will be auto-encoded).
# 4. Apply the secret: kubectl apply -f mongodb-secret.yaml
# 5. Deploy MongoDB: kubectl apply -f ../apps/mongodb.yaml
#
# If you have auth issues after a PVC reset, run:
#   ./scripts/fix-mongodb-auth.sh

apiVersion: v1
kind: Secret
metadata:
  name: mongodb-secret
  namespace: default
type: Opaque
stringData:
  # Root credentials - used for MongoDB admin operations
  mongodb-root-username: root
  mongodb-root-password: <your-secure-root-password>
  
  # Application user credentials - used by services to connect
  # This user will have readWrite access to enginedge-hexagon database
  mongodb-app-username: enginedge
  mongodb-app-password: <your-secure-app-password>
  
  # Connection URI for application services
  # MUST use the app credentials, not root credentials
  # Format: mongodb://<app-user>:<app-password>@mongodb-service:27017/<database>?authSource=admin
  mongodb-uri: mongodb://enginedge:<your-secure-app-password>@mongodb-service:27017/enginedge-hexagon?authSource=admin
